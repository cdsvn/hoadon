<?php/** * Description of Frontend_model * * @author Nguyen Tat Huy * @phone 0988656070 * @email nguyentathuy1986@gmail.com * @skype tim_nguoi_xa_la */class Frontend_model extends CI_Model {    public function __construct() {        parent::__construct();    }    function tree_menu_pure() {        $nodeList = array();        $tree = array();        $rs = $this->db->order_by('parent')->get('menus')->result_array();        foreach ($rs as $row) {            $nodeList[$row['id']] = array_merge($row, array('children' => array()));        }        foreach ($nodeList as $nodeId => &$node) {            if (!$node['parent'] || !array_key_exists($node['parent'], $nodeList)) {                $tree[] = &$node;            } else {                $nodeList[$node['parent']]['children'][] = &$node;            }        }        unset($node);        unset($nodeList);        return $tree;    }    function create_menu_html($tree, $cm, $rm, &$html) {        $ce = count($tree) - 1;        $i = 0;        $classicon = 'fa fa-folder-o';        $active = '';        $style = 'style="display: none;"';        foreach ($tree as $item) {            if ($item['status'] == 1) { // This element have permission                if (empty($item['classicon'])) {                    $classicon = 'fa fa-folder-o';                } else {                    $classicon = $item['classicon'];                }                if (!empty($item['children'])) {                    $active = ' active';                    $style = '';                    $html .= '<li class="treeview ' . $active . '">                    <a href="#">                    <span class = "ico ' . $classicon . '">&nbsp;</span> <span class="tit">' . $this->lang->line($item['route']) . '</span>                    <span class = "arr pull-right"></span>                    </a>                    <ul class = "treeview-menu">';                    $this->create_menu_html($item['children'], $cm, $rm, $html);                } else {                    if ($item['route'] == $cm) {                        $active = ' active';                    } else {                        $active = '';                    }                    $html .= '<li class = "' . $active . '">                    <a href = "' . admin_url($this->admin->lang . '/' . $item['route']) . '">                    <span class = "ico ' . $classicon . '"></span> <span class="tit">' . $this->lang->line($item['route']) . '</span>                    <!--<small class = "label pull-right bg-yellow">12</small>-->                    </a>                    </li>';                }            }            if ($i == $ce) { // close ul li when element end                $html .= '</ul></li>';            }            $i++;        }    }    function get_data($table='') {        $rs = $this->db->where('isdelete', 0)->get($table)->result();        return $rs;    }    function sub_menu($menu_route) {        $sql = "SELECT m.id, m.name, m.route FROM menus m WHERE m.isdelete = 0 AND m.parent = (SELECT mp.id FROM menus mp WHERE mp.route = '$menu_route' AND mp.isdelete=0)";        $rows = $this->db->query($sql)->result();        return $rows;    }}