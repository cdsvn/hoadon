<?phpif (!defined('BASEPATH'))    exit('No direct script access allowed');/*  | -------------------------- |  | @author Nguyen Tat Huy     |  | @copyright 2015            |  | -------------------------- | */include(APPPATH . 'libraries/Template' . EXT);class Admin extends Template {    var $config;    var $time_exit = 0;    var $CI;    var $action;    var $login;    var $lang = '';    function __construct() {        parent::__construct('backend');        $this->set_master_template();        $lang = $this->CI->uri->segment(1);        if ($lang == '') {            redirect('admin.php/vn');        }        $this->lang = $lang;        CI::$APP->config->set_item('language', $lang);        $this->CI->load->model('Admin_model');        CI::$APP->config->set_item('config', $this->CI->Admin_model->get_config());        $this->add_region('copyright');        $this->write('copyright', "© Copyright 2015 | Nguyen Tat Huy", true);        $this->write('title', "Custom Codeigniter", true);    }    /*     * Run the master template or a single region     *     * @access	public     * @param	string	the name of the "view" file to be included.     * @param	string	optionally opt to render a specific region     * @param	boolean	FALSE to output the rendered template, TRUE to return as a string. Always TRUE when $region is supplied     * @return	void or string (result of template build)     */    function run($file, $data = NULL, $region = NULL, $buffer = FALSE, $parse = FALSE) {        $content = $this->CI->load->view($file, $data, true);        $this->write('content', $content);        $this->render($region, $buffer, $parse);    }    function stripHtmlTags($str) {        $text = preg_replace(                array(            // Remove invisible content            '@<head[^>]*?>.*?</head>@siu',            '@<style[^>]*?>.*?</style>@siu',            '@<script[^>]*?.*?</script>@siu',            '@<object[^>]*?.*?</object>@siu',            '@<embed[^>]*?.*?</embed>@siu',            '@<applet[^>]*?.*?</applet>@siu',            '@<noframes[^>]*?.*?</noframes>@siu',            '@<noscript[^>]*?.*?</noscript>@siu',            '@<noembed[^>]*?.*?</noembed>@siu',            // Add line breaks before and after blocks            '@</?((address)|(blockquote)|(center)|(del))@iu',            '@</?((div)|(h[1-9])|(ins)|(isindex)|(p)|(pre))@iu',            '@</?((dir)|(dl)|(dt)|(dd)|(li)|(menu)|(ol)|(ul))@iu',            '@</?((table)|(th)|(td)|(caption))@iu',            '@</?((form)|(button)|(fieldset)|(legend)|(input))@iu',            '@</?((label)|(select)|(optgroup)|(option)|(textarea))@iu',            '@</?((frameset)|(frame)|(iframe))@iu',                ), array(            ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',            "\n\$0", "\n\$0", "\n\$0", "\n\$0", "\n\$0", "\n\$0",            "\n\$0", "\n\$0",                ), $str);        return strip_tags($text);    }    function friendlyUrl($str) {        $unicode = array(            'a' => 'á|à|ả|ã|ạ|ă|ắ|ặ|ằ|ẳ|ẵ|â|ấ|ầ|ẩ|ẫ|ậ',            'd' => 'đ',            'e' => 'é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ',            'i' => 'í|ì|ỉ|ĩ|ị',            'o' => 'ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ',            'u' => 'ú|ù|ủ|ũ|ụ|ư|ứ|ừ|ử|ữ|ự',            'y' => 'ý|ỳ|ỷ|ỹ|ỵ',            'A' => 'Á|À|Ả|Ã|Ạ|Ă|Ắ|Ặ|Ằ|Ẳ|Ẵ|Â|Ấ|Ầ|Ẩ|Ẫ|Ậ',            'D' => 'Đ',            'E' => 'É|È|Ẻ|Ẽ|Ẹ|Ê|Ế|Ề|Ể|Ễ|Ệ',            'I' => 'Í|Ì|Ỉ|Ĩ|Ị',            'O' => 'Ó|Ò|Ỏ|Õ|Ọ|Ô|Ố|Ồ|Ổ|Ỗ|Ộ|Ơ|Ớ|Ờ|Ở|Ỡ|Ợ',            'U' => 'Ú|Ù|Ủ|Ũ|Ụ|Ư|Ứ|Ừ|Ử|Ữ|Ự',            'Y' => 'Ý|Ỳ|Ỷ|Ỹ|Ỵ',        );        foreach ($unicode as $nonUnicode => $uni) {            $str = preg_replace("/($uni)/i", $nonUnicode, $str); // loc dau tieng Viet        }        $str = preg_replace('/[^a-zA-Z0-9\\s-_]/', '', $str); // loai bo cac ky tu khong phai la chu hoac so tru khoang trang, dau - hoac _        $str = trim($str); // loc khoang trang dau chuoi        $str = preg_replace('([\s]+)', '-', $str); // chuyen 1 hoạc nhieu nhieu khoang trang thanh 1 dau gach ngang        $str = preg_replace('([-]+)', '-', $str); // chuyen nhieu dau - thanh 1 dau -        return strtolower($str);    }}function url_tmpl() {    $admin = new Admin();    return base_url() . $admin->path;}function split_content($str, $n) {    $arr = explode(" ", $str, 100);    if ($n >= count($arr)) {        return $str;    } else {        $rt = '';        for ($i = 0; $i < $n; $i++) {            $rt .= $arr[$i] . ' ';        }        return $rt . '...';    }}function configs($key) {    $config = CI::$APP->config->config['config'];    return isset($config[$key]) ? $config[$key] : '';}